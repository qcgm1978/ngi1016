var PoiSDK = window.PoiSDK = PoiSDK || {VERSION: "3.0", CLIENT: "http://127.0.0.1/MapABC-ASA-V3/Client/", SERVER: "http://211.151.71.28:8888/", init: function () {
}};
(function () {
    PoiSDK.MAjaxResult = {};
    PoiSDK.MAjaxRequest = function (e, a, d) {
        this.timer = null;
        this.bCancle = !1;
        var c = Math.round(Math.random() * 1E6), b = document.getElementById("MAjax_" + c);
        b && document.getElementsByTagName("head")[0].removeChild(b);
        b = document.createElement("script");
        b.id = "MAjax_" + c;
        b.type = "text/javascript";
        b.src = e + "&id=" + c;
        var f = this;
        if (typeof d != "undefined")this.timer = setTimeout(function () {
            f.bCancle = !0;
            a({message: "Time out.", count: 0})
        }, d);
        document.getElementsByTagName("head")[0].appendChild(b);
        window.navigator.userAgent.indexOf("MSIE") > 0 ? b.onreadystatechange = function () {
            (this.readyState == "loaded" || this.readyState == "complete") && f.ajaxResult()
        } : b.onload = function () {
            f.ajaxResult()
        };
        this.ajaxResult = function () {
            if (this.timer != null)clearTimeout(this.timer), this.timer = null;
            this.bCancle || (PoiSDK.MAjaxResult[c] ? a(PoiSDK.MAjaxResult[c]) : a({message: "\u7f51\u7edc\u51fa\u73b0\u5f02\u5e38", count: 0}), document.getElementsByTagName("head")[0].removeChild(document.getElementById("MAjax_" + c)), PoiSDK.MAjaxResult[c] =
                null, delete PoiSDK.MAjaxResult[c])
        }
    };
    PoiSDK.LngLat = function (e, a) {
        return{lng: parseFloat(e), lat: parseFloat(a)}
    };
    PoiSDK.PoiSearch = function (e) {
        e.url = PoiSDK.SERVER + "MPoiSearch.php/" + function (a) {
            var d = {charset: "utf-8", srctype: encodeURIComponent("road:1000+roadinter:1000+bus:1000+mpoi"), type: "", number: 10, batch: 1, range: 3E3}, c = "?", b;
            for (b in a)if (b != "timeout" && (d[b] != void 0 && d[b] != "" || a[b] != void 0 && a[b] != ""))c += b + "=" + encodeURI(a[b] || d[b]) + "&";
            return c
        }(e || {});
        typeof e.timeout != "number" && (e.timeout = 3E4);
        return{byKeywords: function (a, d, c) {
            a = e.url + "act=PoiSearchByKeywords&keyword=" + encodeURIComponent(a) + "&city=" + encodeURI(d);
            new PoiSDK.MAjaxRequest(a, c, e.timeout)
        }, byCenPoi: function (a, d, c) {
            typeof a === "object" && (a = a.lng + "," + a.lat);
            a = e.url + "act=PoiSearchByCenPoi&cenXY=" + a + "&keyword=" + encodeURI(d).replace(/#/g, "");
            new PoiSDK.MAjaxRequest(a, c, e.timeout)
        }, inputPrompt: function (a, d, c) {
            var b = "city";
            isNaN(d) || (b = "citycode");
            a = e.url + "act=PoiSearchInputPrompt&keyword=" + encodeURIComponent(a).replace(/#/g, "") + "&" + b + "=" + encodeURI(d);
            new PoiSDK.MAjaxRequest(a,
                c)
        }}
    };
    PoiSDK.Geocoder = function (e) {
        e.url = PoiSDK.SERVER + "MPoiSearch.php/" + function (a) {
            var d = {poinum: 10, roadnum: 10, crossnum: 3, range: 3E3}, c = "?", b;
            for (b in a)if (d[b] != void 0 && d[b] != "" || a[b] != void 0 && a[b] != "")c += b + "=" + encodeURI(a[b].toString() || d[b]) + "&";
            return c
        }(e || {});
        return{geocode: function (a, d) {
            var c = e.url + "act=GeoSearchByKeyword&keyword=" + encodeURIComponent(a);
            new PoiSDK.MAjaxRequest(c, d)
        }, regeocode: function (a, d) {
            typeof a === "object" && (a = a.lng + "," + a.lat);
            new PoiSDK.MAjaxRequest(e.url + "act=RGeoSearchByLngLat&XY=" +
                a, d)
        }}
    }
})();
